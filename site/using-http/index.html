


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.2.0">
    
    
      
        <title>Using HTTP - </title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.18ac144a.min.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/palette.616af814.min.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../css/a.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#using-http-to-interact-with-citrix-hypervisor" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="" class="md-header-nav__button md-logo" aria-label="">
      
  <img src="../media/logo3.jpg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Using HTTP
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="" class="md-nav__button md-logo" aria-label="">
      
  <img src="../media/logo3.jpg" alt="logo">

    </a>
    
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../using/" title="Using" class="md-nav__link">
      Using
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Using HTTP
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Using HTTP" class="md-nav__link md-nav__link--active">
      Using HTTP
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vm-import-and-export" class="md-nav__link">
    VM Import and Export
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-citrix-hypervisor-performance-statistics" class="md-nav__link">
    Getting Citrix Hypervisor Performance Statistics
  </a>
  
    <nav class="md-nav" aria-label="Getting Citrix Hypervisor Performance Statistics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#additional-rrd_updates-parameters" class="md-nav__link">
    Additional rrd_updates parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../xs-api-extensions/" title="Citrix Hypervisor Management API Extensions" class="md-nav__link">
      Citrix Hypervisor Management API Extensions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../xc-api-extensions/" title="XenCenter API Extension" class="md-nav__link">
      XenCenter API Extension
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vm-import-and-export" class="md-nav__link">
    VM Import and Export
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-citrix-hypervisor-performance-statistics" class="md-nav__link">
    Getting Citrix Hypervisor Performance Statistics
  </a>
  
    <nav class="md-nav" aria-label="Getting Citrix Hypervisor Performance Statistics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#additional-rrd_updates-parameters" class="md-nav__link">
    Additional rrd_updates parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="using-http-to-interact-with-citrix-hypervisor">Using HTTP to interact with Citrix Hypervisor</h1>
<p>Citrix Hypervisor exposes an HTTP interface on each host, that can be used
to perform various operations. This chapter describes the available
mechanisms.</p>
<h2 id="vm-import-and-export">VM Import and Export</h2>
<p>Because the import and export of VMs can take some time to complete, an
asynchronous HTTP interface to the import and export operations is
provided. To perform an export using the Citrix Hypervisor Management API, construct
an HTTP GET call providing a valid session ID, task ID and VM UUID, as
shown in the following pseudo code:</p>
<pre><code class="python">    task = Task.create()
    result = HTTP.get(server, 80, &quot;/export?session_id=session_id&amp;task_id=task_id&amp;ref=vm_uuid&quot;);
</code></pre>

<p>For the import operation, use an HTTP PUT call as demonstrated in the
following pseudo code:</p>
<pre><code class="python">    task = Task.create()
    result = HTTP.put(server, 80, &quot;/import?session_id=session_id&amp;task_id=task_id&amp;ref=vm_uuid&quot;);
</code></pre>

<h2 id="getting-citrix-hypervisor-performance-statistics">Getting Citrix Hypervisor Performance Statistics</h2>
<p>Citrix Hypervisor records statistics about the performance of various
aspects of your Citrix Hypervisor installation. The metrics are stored
persistently for long term access and analysis of historical trends.
Where storage is available to a VM, the statistics are written to disk
when a VM is shut down. Statistics are stored in RRDs (Round Robin
Databases), which are maintained for individual VMs (including the
control domain) and the server. RRDs are resident on the server on which
the VM is running, or the pool master when the VM is not running. The
RRDs are also backed up every day.</p>
<blockquote>
<p><strong>Warning</strong></p>
<p>In earlier versions of the Citrix Hypervisor Management API, instantaneous
performance metrics could be obtained using the <code>VM_metrics</code>,
<code>VM_guest_metrics</code>, <code>host_metrics</code> methods and associated methods.
These methods has been deprecated in favor of using the http handler
described in this chapter to download the statistics from the RRDs on
the VMs and servers. Note that by default the legacy metrics will
return zeroes. To revert to periodic statistical polling as present in
earlier versions of Citrix Hypervisor, set the
<code>other-config:rrd_update_interval=interval</code> parameters on your host to one of the following values,
and restart your host:</p>
<p><strong>never</strong> :   This is the default, meaning no periodic polling is performed.</p>
<p><strong>1</strong> :   Polling is performed every 5 seconds.</p>
<p><strong>2</strong> :   Polling is performed every minute.</p>
<p>By default, the older metrics APIs will not return any values, and so
this key must be enabled to run monitoring clients which use the
legacy monitoring protocol.</p>
</blockquote>
<p>Statistics are persisted for a maximum of one year, and are stored at
different granularities. The average and most recent values are stored
at intervals of:</p>
<ul>
<li>
<p>5 seconds for the past 10 minutes</p>
</li>
<li>
<p>one minute for the past 2 hours</p>
</li>
<li>
<p>one hour for the past week</p>
</li>
<li>
<p>one day for the past year</p>
</li>
</ul>
<p>RRDs are saved to disk as uncompressed XML. The size of each RRD when
written to disk ranges from 200KiB to approximately 1.2MiB when the RRD
stores the full year of statistics.</p>
<blockquote>
<p><strong>Warning</strong></p>
<p>If statistics cannot be written to disk, for example when a disk is
full, statistics will be lost and the last saved version of the RRD
will be used.</p>
</blockquote>
<p>Statistics can be downloaded over HTTP in XML format, for example using
<code>wget</code>. See <a href="http://oss.oetiker.ch/rrdtool/doc/rrddump.en.html">rrddump</a>
and <a href="http://oss.oetiker.ch/rrdtool/doc/rrdxport.en.html">rrdxport</a> for
information about the XML format. HTTP authentication can take the form
of a username and password or a session token. Parameters are appended
to the URL following a question mark (?) and separated by ampersands
(&amp;).</p>
<p>To obtain an update of all VM statistics on a host, the URL would be of
the form:</p>
<pre><code>http://username:password@host/rrd_updates?start=secondssinceepoch
</code></pre>
<p>This request returns data in an rrdtool <code>xport</code> style XML format, for
every VM resident on the particular host that is being queried. To
differentiate which column in the export is associated with which VM,
the <code>legend</code> field is prefixed with the UUID of the VM.</p>
<p>To obtain host updates too, use the query parameter <code>host=true</code>:</p>
<pre><code>http://username:password@host/rrd_updates?start=secondssinceepoch&amp;host=true
</code></pre>
<p>The step will decrease as the period decreases, which means that if you
request statistics for a shorter time period you will get more detailed
statistics.</p>
<h3 id="additional-rrd_updates-parameters">Additional rrd_updates parameters</h3>
<p><code>cf= ave|min|max</code>:   the data consolidation mode</p>
<p><code>interval= interval</code>:   the interval between values to be reported</p>
<blockquote>
<p><strong>Note</strong></p>
<p>By default only <code>ave</code> statistics are available. To obtain <code>min</code> and
<code>max</code> statistics for a VM, run the following command:</p>
<pre><code>xe pool-param-set uuid=pool_uuid other-config:create_min_max_in_new_VM_RRDs
</code></pre>
</blockquote>
<p>To obtain all statistics for a host:</p>
<pre><code>http://username:password@host/host_rrd
</code></pre>
<p>To obtain all statistics for a VM:</p>
<pre><code>http://username:password@host/vm_rrd?uuid=vm_uuid
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../using/" title="Using" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Using
              </div>
            </div>
          </a>
        
        
          <a href="../xs-api-extensions/" title="Citrix Hypervisor Management API Extensions" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Citrix Hypervisor Management API Extensions
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.d710d30a.min.js"></script>
      <script src="../assets/javascripts/bundle.5f27aba8.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.27c6a5e6.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>